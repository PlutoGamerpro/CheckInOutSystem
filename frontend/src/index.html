<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Check In/Out</title>
  <base href="/">

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <!-- Cool: theme color + preconnects -->
  <meta name="theme-color" content="#0ea5e9">
  <meta name="color-scheme" content="light">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <style>
    :root { --brand:#0ea5e9; --ok:#16a34a; --bad:#dc2626; }
    html,body{height:100%;}
    body{
      margin:0;
      font-family:'Poppins','Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(14,165,233,.15), transparent 70%),
        radial-gradient(900px 500px at 90% 30%, rgba(99,102,241,.12), transparent 70%),
        linear-gradient(180deg, #f7fafc 0%, #eef2ff 100%);
    }
    /* Loading overlay */
    #boot-overlay{
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background:rgba(255,255,255,.85); backdrop-filter:blur(6px);
      z-index:9999; transition:opacity .3s ease;
    }
    #boot-overlay.hidden{ opacity:0; pointer-events:none; }
    .spinner{
      width:42px; height:42px; border:3px solid rgba(14,165,233,.25);
      border-top-color:var(--brand); border-radius:50%; animation:spin 1s linear infinite; margin-right:12px;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .boot-label{ font-weight:600; letter-spacing:.2px; color:#0f172a; }

    /* API status pill */
    #api-status{
      position:fixed; right:14px; bottom:14px; background:#fff; border-radius:999px;
      box-shadow:0 6px 18px rgba(0,0,0,.12); padding:8px 12px; display:flex; gap:8px; align-items:center;
      font-size:12px; font-weight:600; color:#334155; z-index:9999;
    }
    #api-status .dot{ width:8px; height:8px; border-radius:50%; background:#d1d5db; }
    #api-status.online .dot{ background:var(--ok); }
    #api-status.offline .dot{ background:var(--bad); }
  </style>
</head>
<body>
  <!-- Added: loading overlay + API status badge -->
  <div id="boot-overlay">
    <div class="spinner"></div>
    <div class="boot-label">Loading Check In/Out…</div>
  </div>
  <div id="api-status"><span class="dot"></span><span class="txt">API: checking…</span></div>

  <app-root></app-root>

  <script>
    (function () {
      const overlay = document.getElementById('boot-overlay');
      // Hide overlay shortly after the page finishes loading
      window.addEventListener('load', () => setTimeout(() => overlay.classList.add('hidden'), 300));

      // API Health check badge
      const badge = document.getElementById('api-status');
      const txt = badge.querySelector('.txt');
      function setState(state, message){
        badge.classList.remove('online','offline');
        badge.classList.add(state);
        txt.textContent = message;
      }
      async function ping(){
        try{
          const res = await fetch('/api/health', { method:'GET', cache:'no-store' });
          if(res.ok){ setState('online','API: online'); }
          else { setState('offline','API: issues'); }
        }catch(_){ setState('offline','API: offline'); }
      }
      ping();
      setInterval(ping, 30000);
    })();
  </script>
</body>
</html>
